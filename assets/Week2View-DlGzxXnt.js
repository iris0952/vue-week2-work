import{r as l,d as V,c as n,a as e,w as p,v,f as x,t as i,h as $,F as f,o as a}from"./index-CYPwjz8i.js";import{a as m}from"./axios-C8DqakIB.js";const E=e("h1",null,"Week2 作業",-1),I=e("h2",null,"註冊",-1),C=e("br",null,null,-1),F={key:0,class:"text-danger"},M={key:1,class:"text-danger"},N=e("h2",null,"登入",-1),B=e("br",null,null,-1),D={key:0,class:"text-danger"},z={key:1,class:"text-danger"},A=e("h2",null,"驗證",-1),P={key:0},R={key:1},W=e("h2",null,"登出",-1),L={key:0},O=e("h2",null,"Todo List",-1),S=e("table",null,[e("thead",null,[e("tr",null,[e("th",null,"代辦事項"),e("th"),e("th")])]),e("tbody",null,[e("tr",null,[e("td"),e("td"),e("td")])])],-1),j=[O,S],h="https://todolist-api.hexschool.io",J={__name:"Week2View",setup(q){const u=l({email:"",password:"",nickname:""}),k=l(""),_=l(""),b=async()=>{try{const t=await m.post(`${h}/users/sign_up`,u.value);console.log(t),k.value="註冊成功"}catch(t){console.log(t),_.value=t.response.data.message}},d=l({email:"",password:""}),y=l(""),g=l(""),U=async()=>{try{const t=await m.post(`${h}/users/sign_in`,d.value);console.log(t),y.value="登入成功",document.cookie=`customTodoToken=${t.data.token};`}catch(t){console.log(t),g.value=t.response.data.message}},c=l({nickname:"",uid:""}),r=l("");V(async()=>{const t=document.cookie.replace(/(?:(?:^|.*;\s*)customTodoToken\s*=\s*([^;]*).*$)|^.*$/,"$1");r.value=t,console.log(t),t&&T()});const T=async()=>{try{const t=await m.get(`${h}/users/checkout`,{headers:{Authorization:r.value}});c.value=t.data}catch(t){console.log(t.response.data.message),w()}},w=async()=>{try{await m.post(`${h}/users/sign_out`,{},{headers:{Authorization:r.value}}),r.value="",document.cookie="customTodoToken=;",c.value={}}catch(t){console.log(t.response.data.message)}};return(t,o)=>(a(),n(f,null,[E,e("div",null,[I,p(e("input",{type:"email",placeholder:"Email","onUpdate:modelValue":o[0]||(o[0]=s=>u.value.email=s)},null,512),[[v,u.value.email]]),p(e("input",{type:"text",placeholder:"Password","onUpdate:modelValue":o[1]||(o[1]=s=>u.value.password=s)},null,512),[[v,u.value.password]]),p(e("input",{type:"text",placeholder:"暱稱","onUpdate:modelValue":o[2]||(o[2]=s=>u.value.nickname=s)},null,512),[[v,u.value.nickname]]),e("button",{type:"button",onClick:b},"註冊"),x(),C,_.value?(a(),n("p",F,i(_.value),1)):(a(),n("p",M,i(k.value),1))]),e("div",null,[N,p(e("input",{type:"email",placeholder:"Email","onUpdate:modelValue":o[3]||(o[3]=s=>d.value.email=s)},null,512),[[v,d.value.email]]),p(e("input",{type:"text",placeholder:"Password","onUpdate:modelValue":o[4]||(o[4]=s=>d.value.password=s)},null,512),[[v,d.value.password]]),e("button",{type:"button",onClick:U},"登入"),x(),B,g.value?(a(),n("p",D,i(g.value),1)):(a(),n("p",z,i(y.value),1))]),e("div",null,[A,c.value.uid?(a(),n("div",P,[e("p",null,"UID: "+i(c.value.uid),1),e("p",null,"Nickname: "+i(c.value.nickname),1)])):(a(),n("div",R,"你還沒有登入喔！"))]),e("div",null,[W,e("button",{type:"button",onClick:w},"登出")]),r.value?(a(),n("div",L,j)):$("",!0)],64))}};export{J as default};
