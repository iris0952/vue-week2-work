import{r as n,d as V,c as a,a as o,w as r,v as p,f as x,t as i,F as $,o as u}from"./index-L0T3g9cb.js";import{a as m}from"./axios-C8DqakIB.js";const f=o("h1",null,"Week2 作業",-1),E=o("h2",null,"註冊",-1),I=o("br",null,null,-1),F={key:0,class:"text-danger"},M={key:1,class:"text-danger"},B=o("h2",null,"登入",-1),C=o("br",null,null,-1),D={key:0,class:"text-danger"},N={key:1,class:"text-danger"},z=o("h2",null,"驗證",-1),A={key:0},P={key:1},R=o("h2",null,"登出",-1),g="https://todolist-api.hexschool.io",j={__name:"Week2View",setup(W){const l=n({email:"",password:"",nickname:""}),_=n(""),k=n(""),U=async()=>{try{const e=await m.post(`${g}/users/sign_up`,l.value);console.log(e),_.value="註冊成功"}catch(e){console.log(e),k.value=e.response.data.message}},c=n({email:"",password:""}),y=n(""),h=n(""),b=async()=>{try{const e=await m.post(`${g}/users/sign_in`,c.value);console.log(e),y.value="登入成功",document.cookie=`customTodoToken=${e.data.token};`}catch(e){console.log(e),h.value=e.response.data.message}},d=n({nickname:"",uid:""}),v=n("");V(async()=>{const e=document.cookie.replace(/(?:(?:^|.*;\s*)customTodoToken\s*=\s*([^;]*).*$)|^.*$/,"$1");v.value=e,console.log(e),e&&T()});const T=async()=>{try{const e=await m.get(`${g}/users/checkout`,{headers:{Authorization:v.value}});d.value=e.data}catch(e){console.log(e.response.data.message),w()}},w=async()=>{try{await m.post(`${g}/users/sign_out`,{},{headers:{Authorization:v.value}}),v.value="",document.cookie="customTodoToken=;",d.value={}}catch(e){console.log(e.response.data.message)}};return(e,s)=>(u(),a($,null,[f,o("div",null,[E,r(o("input",{type:"email",placeholder:"Email","onUpdate:modelValue":s[0]||(s[0]=t=>l.value.email=t)},null,512),[[p,l.value.email]]),r(o("input",{type:"text",placeholder:"Password","onUpdate:modelValue":s[1]||(s[1]=t=>l.value.password=t)},null,512),[[p,l.value.password]]),r(o("input",{type:"text",placeholder:"暱稱","onUpdate:modelValue":s[2]||(s[2]=t=>l.value.nickname=t)},null,512),[[p,l.value.nickname]]),o("button",{type:"button",onClick:U},"註冊"),x(),I,k.value?(u(),a("p",F,i(k.value),1)):(u(),a("p",M,i(_.value),1))]),o("div",null,[B,r(o("input",{type:"email",placeholder:"Email","onUpdate:modelValue":s[3]||(s[3]=t=>c.value.email=t)},null,512),[[p,c.value.email]]),r(o("input",{type:"text",placeholder:"Password","onUpdate:modelValue":s[4]||(s[4]=t=>c.value.password=t)},null,512),[[p,c.value.password]]),o("button",{type:"button",onClick:b},"登入"),x(),C,h.value?(u(),a("p",D,i(h.value),1)):(u(),a("p",N,i(y.value),1))]),o("div",null,[z,d.value.uid?(u(),a("div",A,[o("p",null,"UID: "+i(d.value.uid),1),o("p",null,"Nickname: "+i(d.value.nickname),1)])):(u(),a("div",P,"你還沒有登入喔！"))]),o("div",null,[R,o("button",{type:"button",onClick:w},"登出")])],64))}};export{j as default};
